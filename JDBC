import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class JdbcCrudExample {

    private static final String JDBC_URL = "jdbc:mysql://localhost:3306/student_database";
    private static final String USERNAME = "your_username";
    private static final String PASSWORD = "your_password";

    public static void main(String[] args) {
        // Open the connection
        try (Connection connection = DriverManager.getConnection(JDBC_URL, USERNAME, PASSWORD)) {

            // Insert a student into the database
            insertStudent(connection, "Öncel", "Özalp", 34);

            // Retrieve the list of students
            System.out.println("List of Students:");
            listStudents(connection);

            // Update a student
            updateStudent(connection, 1, "Öncel", "Özalp", 35);

            // Retrieve the updated list of students
            System.out.println("Updated List of Students:");
            listStudents(connection);

            // Delete a student
            deleteStudent(connection, 2);

            // Retrieve the list of deleted students
            System.out.println("List of Deleted Students:");
            listStudents(connection);

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    private static void insertStudent(Connection connection, String firstName, String lastName, int age) throws SQLException {
        String insertQuery = "INSERT INTO students (first_name, last_name, age) VALUES (?, ?, ?)";
        try (PreparedStatement preparedStatement = connection.prepareStatement(insertQuery)) {
            preparedStatement.setString(1, firstName);
            preparedStatement.setString(2, lastName);
            preparedStatement.setInt(3, age);
            preparedStatement.executeUpdate();
        }
        System.out.println("Student added: " + firstName + " " + lastName);
    }

    private static void listStudents(Connection connection) throws SQLException {
        String selectQuery = "SELECT * FROM students";
        try (PreparedStatement preparedStatement = connection.prepareStatement(selectQuery);
             ResultSet resultSet = preparedStatement.executeQuery()) {

            while (resultSet.next()) {
                System.out.println("ID: " + resultSet.getInt("id") +
                        ", First Name: " + resultSet.getString("first_name") +
                        ", Last Name: " + resultSet.getString("last_name") +
                        ", Age: " + resultSet.getInt("age"));
            }
        }
    }

    private static void updateStudent(Connection connection, int studentId, String firstName, String lastName, int age) throws SQLException {
        String updateQuery = "UPDATE students SET first_name = ?, last_name = ?, age = ? WHERE id = ?";
        try (PreparedStatement preparedStatement = connection.prepareStatement(updateQuery)) {
            preparedStatement.setString(1, firstName);
            preparedStatement.setString(2, lastName);
            preparedStatement.setInt(3, age);
            preparedStatement.setInt(4, studentId);
            preparedStatement.executeUpdate();
        }
        System.out.println("Student updated: " + firstName + " " + lastName);
    }

    private static void deleteStudent(Connection connection, int studentId) throws SQLException {
        String deleteQuery = "DELETE FROM students WHERE id = ?";
        try (PreparedStatement preparedStatement = connection.prepareStatement(deleteQuery)) {
            preparedStatement.setInt(1, studentId);
            preparedStatement.executeUpdate();
        }
        System.out.println("Student deleted: ID " + studentId);
    }
}
